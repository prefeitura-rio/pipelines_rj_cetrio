WITH loc AS (
  SELECT
    camera_numero,
    locequip,
    CAST(t1.latitude AS FLOAT64) AS latitude,
    CAST(t1.longitude AS FLOAT64) AS longitude,
  FROM `rj-cetrio.ocr_radar.equipamento` t1
  JOIN `rj-cetrio.ocr_radar.equipamento_codcet_to_camera_numero` t2
    ON t1.codcet = t2.codcet
),

tb AS (
  SELECT
    t1.placa,
    t1.tipoveiculo,
    t1.velocidade,
    DATETIME(t1.datahora, 'America/Sao_Paulo') AS datahora,
    t1.camera_numero,
    t1.empresa,
    COALESCE(t2.latitude, t1.camera_latitude) AS latitude,
    COALESCE(t2.longitude, t1.camera_longitude) AS latitude,
    DATETIME(t1.datahora_captura, 'America/Sao_Paulo') AS datahora_captura,
  FROM `rj-cetrio.ocr_radar.readings_*` t1
  JOIN loc t2
  ON t1.camera_numero = t2.camera_numero
)

SELECT
  *
FROM tb t1
WHERE placa IN (
"KYP2H75", "LMJ2571", "LPG7B00", "SRG4J27", "SRJ3D65", "CUB3E76", "PUC0E05", "SQZ8J20", "RUF9E33", "LMS1I20",
"RFB6J14", "ALM4D51", "QMS1D27", "CUC7187", "SHY9C05", "DPC2959", "KYP2H75", "BTO4074", "DFQ8E42", "RKS6G41",
"GVQ7B56", "LQI1632", "PPM5956", "KQU3G08", "KYP2H75", "SHG5G32", "RNB1E72", "RNB1E68", "KPU3F24", "LUT3922",
"QRK2B21", "BUP5981", "RKU4H63", "LKP5A08", "JRP3870", "HEZ8322", "CZC1452", "MRN6B04", "NKX8C02", "QUL1507",
"LTH3605", "ATB9088", "LSO8A92", "RNB8B99", "PPA0I86", "MSD2166", "RTO9B52", "CZC1375", "RNY3H55", "EBD7512",
"KYB8687", "LPU7341", "DBC0663", "LMQ1A34", "PPZ6852", "RKS9D52", "KQP9064", "FRC6D74", "QRG5A18", "LRI4A07",
"GSW8245", "GXM6I79", "MQC4D78", "QQZ4873", "RJQ7G20", "KTF2677", "IPR8F90", "BAZ7F44", "KRV6E97", "GBR1H72",
"RQT1H81", "LMZ2563", "DTC6H55", "FKP8599", "IRB1A29", "KRK6758", "TUC0E05", "RIV1J89", "KGS6D44", "LPO0B97",
"LTH3605", "ELW4C31", "IRU8E99", "FGW9J83", "MSG0D48", "OVH4353", "OOX9E31", "RQT8I59", "OXC9I64", "KPG5A38",
"GHQ1F27", "RJG0H79", "JRP5175", "DJF9123", "MRN6303", "BAZ9C22", "RCV4E30", "PPB5226", "QPN9119", "EHH9A97",
"ADZ0A83", "RBF9G40", "FSM3B95", "QRE0H74", "RBA8C01", "ADZ0A84", "FTA3G07", "LOW9190", "JRP3870", "RNG6G92",
"EON1632", "RKA2R18", "LTO7F07", "OOW5E93", "DBM3973", "KVR9813", "QQZ4I73", "GKR7681", "INY6H05", "JQI0516",
"COH2944", "KWE7257", "AMH6F62", "DTE9C76", "OUO7G70", "RKC3C73", "GAT5B23", "OVI0I65", "KVX2J25", "GVJ5C18",
"CUT9D89", "QNT2265", "LRQ8C93", "HBN3B05", "CZX4G41", "LTD2F84", "SNK9E32", "AML4A96", "RQQ1D99", "EWU3530",
"CSK4980", "PXF8F87", "ODE5I86", "FEI1F45", "NLQ1830", "LNU8119", "BEL5B66", "RMW5C52", "FYD0C43", "DBM2684",
"RKG5B15", "LTG9D21", "QNT2263", "KYV0A64", "LKF1689", "GEV1E86", "KWJ6E77", "LQI8G02", "RMV5E54", "KUG1327",
"OVI0215", "LLM1560", "QRJ5G05", "RJN4E55", "BTO2E44", "KRF5G60", "KNU4724", "LRK3B08", "RUZ7J64", "KQS5035",
"BCW8F71", "EVO8D67", "BCX0J42", "GYG1C96", "CVH5879", "DJF2E05", "BSY8F77", "BDM9F61", "JVB8F25", "KZB2E21",
"RKS3C15", "LHG7280", "BCB6479", "GYG1C96", "DJF2E05", "LNV4976", "PPA1620", "OCZ8A39", "RJP4J28", "RKG5B15",
"LPI8B73", "AML4A96", "RQO4J78", "MSP8004", "RNQ1A69", "DSF0G43", "RBC4B53", "LRA1540", "KTF2677", "DJC1E39",
"PPA1619", "RKS3C15", "KXU9B97", "SUR0D00", "RUP2B01", "KQU3G08", "LTG9D21", "DTE9C76", "DBC0H20", "GAT8G42",
"KVT7D89", "NZB1I04", "ANZ5398", "KMQ8E67", "RJJ1J53", "SUF4E69", "RQO2C53", "GZG7H30", "RJI3E31", "RVD3G04",
"EXO0E32", "HNB3B05", "LVE4B31", "ESU3673", "PUY2G46", "CUA0110", "GAT6D71", "KXM4G10", "SGO1F74", "GZG7H30",
"LTS6G51", "GBC2B95", "GCV5291", "RQT2F66", "MSG2D56", "RJJ1J53", "LSF1J23", "LTW1J70", "MTL5E82", "ETP5J62",
"OQY7C75", "LUJ7F01", "RKC2E84", "ETP5J62", "MSP5E82", "RBC7D37", "LTU7D09", "RKC2E84", "RKC2E84", "KQC3613",
"RUF7H93", "MTW9F88", "OKH1F87", "LLT0G51", "RNB1D24", "RNI2B36", "EVK8C42", "HNB3B05", "SQD5D54", "LYU4F83",
"QNS1B37", "MLW3698", "KMW6D13", "SIY4D12", "AMS6784", "BTO2E44", "LMI5328", "MYM3C86", "GAT2H91", "LTG9D21",
"DPE7D88", "FXM4830", "LVB2I15", "OBR7C02", "EGG5F91", "EVO8D67", "PYD2655", "FOH0G73", "SFY3E03", "BBC4F13",
"AMH6F62", "OAX2H31", "LTS6G51", "MRI1C33", "EVO3B10", "LRH6994", "SFE7C39", "RVW1G21", "GVJ4300", "JZZ0299",
"ERJ6I77", "KXI3038", "LSV3722", "GXM6181", "LVB5225", "RBH7A92", "PXL5090", "AWL9J08", "CZC1161", "KWJ6E77",
"GBB7B37", "OCZ8A39", "QYU7I76", "LPR3928", "CUD4F32", "EJX6372", "BCW8F70", "QQZ7963", "LSY3192", "OWW5363",
"RTQ6C61", "BTO2E44", "GBB7B37", "RQS1B67", "PPH6903", "FEC7111", "DCM9F21", "KYB8687", "FCI1D21", "LLO7679",
"ODP4H23", "RCI9640", "FRF2J02", "QOC9H28", "KQQ6449", "NKX4768", "LUF4144", "SFX5J60", "MSM9G50", "KZN7G68",
"KRG3050", "HIH2508", "LOB8940", "GAT2H81", "KXW7911", "GKE5H93", "SFE7C39", "MRB2077", "GYW7625", "CSK3190",
"PEV3694", "HNB3B05", "CRY5080", "OQG1F35", "DBM2684", "LLM6C09", "RQQ9E33", "GEX6A27", "JZH9231", "QUH5938",
"FDF1D35", "KPD9J73", "CSK3180", "PWN2I55", "LNP5770", "REA5G17", "ATT4214", "LTO7F07", "LSR4555", "HTE3165",
"LUJ7F01", "RUZ7161", "GAL2998", "EAM4A92", "AXF4B41", "HJA9622", "LRS4I19", "GEX6A27", "DBL6D38", "DHI5930",
"BDH4A21", "LRN8H47", "LPR3928", "DBC0H20", "RQQ1A73", "LMW9B24", "RNC6G95", "KXE7903", "LLM1560", "AQD5D51",
"RKT1C43", "OCW9980", "STS2H29", "RBA2D45", "RHT6F63", "RKC3C73", "KYI6010", "CSN8C43", "HNB3B05", "HKH0763",
"GYG1C96", "CSK4A61", "RNL9J58", "LMI4741", "KUF2030", "BCN0891", "LMW9B24", "LSY2A22", "ERA9258", "DTE3F63",
"LTO7F07", "KXR6841", "RQS2B93", "FYD0C43", "OPK5186", "SQY7I45", "KPE1819", "EUD5F88", "QRG7A05", "LQX2510",
"LUO2G27", "FIU1100", "GPZ9095", "QUG1414", "LTS6G51", "CYN8498", "RKF4H42", "KPE1819", "KRG7E90", "LRL2H28",
"DKO1E29", "QRJ5F99", "DJE9582", "PZX1934", "GZV3383", "LMD8448", "KOS8323", "RNI2B32", "RTW2B44", "KWC3496",
"ANZ5345", "RQS1F19", "KWB9I57", "JMO8348", "OOM5377", "LZB6E31", "OYH0A96", "RBC4B54", "KRG7E90", "DJC1E39",
"CZX4H36", "JAB4H28", "OKB2F75", "LSR4555", "DBM2684", "FSN6D70", "KWC3496", "RVC4F25", "STE0I49", "FYD0C43",
"EPG9J66", "JBE6H91", "LSK3939", "QRG8D00", "CSK4A61", "RIS6G06", "OYJ6A18", "LRZ9861", "QTZ2I99", "DJC7816",
"KRH4D38", "FLO0G98", "KRC9E90", "LPB2E97", "LUI4F37", "LTW8D41", "KWJ6E77", "KWE1D40", "QWY5513", "ORA3C42",
"QPJ8J12", "QWZ1408", "FCZ2765", "GYG1C96", "JJZ3043", "PVT7826", "QPB5397", "LRL5006", "DBC0H20", "QRI3D08",
"FGW9J83", "AMH6F62", "RKS3C15", "MPW8129", "SQZ2E64", "SHY7B24", "LMT5H32", "KYP2H75", "PWR7G98", "GMC5840",
"KSW3A86", "MGR7B77", "OWK2765", "KQY4E94", "RTO9B52", "FGW9J83", "ODR5783", "EUD5F88", "AMS6774", "MRC2858",
"LQZ9243", "RJL7B86", "DDA3J10", "RQT1H81", "DBM1545", "OYJ6A18", "EHH9B01", "ALK5I41", "NVW1494", "RKG5B15",
"CZB1A52", "PWK2H86", "ODJ3995", "DJC1E39", "ODF5J83", "QNT2265", "DBM2684", "KVI8G65", "RKC3C73", "PPD5G69",
"HEH1243", "DVS9156", "FEI1548", "RJJ1M16", "GIB0E37", "EOA1B38", "GYS5798", "OCZ8A39", "EJG1E36", "OYD9021",
"LVB2I15", "EHH9A97", "LTO7F07", "BPQ4J14", "LNP5770", "KRF5G62", "HJD0097", "RQQ9B69", "DBM1544", "KPU9345",
"RJI3E31", "CUD0B08", "FTL9F95", "QUA4A74", "RIX5D18", "KYB9108", "LUO0F53", "QNS1B37", "QNT2263", "LUO2G27",
"RIX3J39", "SFV6C43", "LSI3027", "RKO5E36", "CYB1170", "OXB9D01", "PQN2I58", "CPR8152", "DJC1E39", "QUX9818",
"RKV5I17", "RQT8159", "CNI-887", "EJW9G76", "RJG1A26", "OOM5378", "HBN7H18", "GYS5797", "PUY2G46", "LQO9539",
"LPY4011", "DJF2E05", "BTO2E44", "OYH8I25", "FIF7E91", "RIY1D98", "FMF3607", "MGI5C34", "HDR9373", "HTE3166",
"LPY3J46", "KWE1D40", "DDA3J10", "RZP2G71", "LTM2563", "LPR3928", "PUS7E83", "LTV5651", "BBE9C55", "RTT1I10",
"EHH9B01", "OMF5038", "CRY2805", "OYH0A96", "SUH4I59", "KOQ7B77", "BDM9F61", "HGJ7819", "AML4A96", "AZW1A20",
"QNT0134", "ODF5J83", "RJK2D65", "RKC3C73", "PUD9718", "KOA8I18", "KXM4811", "LMS1120", "RKV3I51", "RNE5G06",
"RJJ1J53", "NPZ1991", "OCZ7867", "LUI4F37", "LTY9E84", "FWF2104", "LQW9190", "EVW6I59", "IYR6990", "KXW 791",
"KOX7C25", "LQI8G02", "LRS2642", "PPI2875", "RIT4I67", "NZP1991", "LTN8H52", "LQB7E58", "KYY4C65", "KRH4D38",
"IYF1H15", "LMV5G55", "RKQ7A80", "RKI4H48", "CPJ6C50", "CPJ6C51", "HIJ7J25", "HIJ7J24", "LLN3C58", "RKL9E31",
"DVS9D45", "DVS9D46", "APP8I82", "NLN 3A8", "NLN3A92", "DPC2A86", "AST9D46", "AST9D45", "HOA1C91", "BQP0F65",
"AQR7I04", "KWD3I39", "LLH2G70", "HOA1I13", "HOA1I12", "CPN3A45", "CPN3A35", "NPE2C43", "NPE2C53", "LQG9J89",
"OPH3I59", "OPH3I77", "AXV4D66", "LMS0C05"
)
ORDER BY datahora